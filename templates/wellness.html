{% extends 'base.html' %}

{% block content %}
    <title>Wellness Page</title>

    <div class="container mt-4">
        <div class="row">
            <div class="col-md-6">
                <div class="content-box">
                    <h2>Moody Journal</h2>
                    <form id="journalForm">
                        <div class="form-group">
                            <label for="journalEntry">Write your journal entry:</label>
                            <textarea id="journalEntry" name="journal_entry" rows="4" cols="50" class="form-control"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Save Journal Entry</button>
                    </form>

                    <h3>Journal Box (Date, Total Entries)</h3>
                    <div id="journalEntries" style="display: none;">
                        <ul>
                            {% for entry in user_journal_entries %}
                                <li>
                                    <span>{{ entry.date }}, {{ entry.id }}</span>
                                    <a href="{{ url_for('edit_journal_entry', date=entry.date, id=entry.id) }}" class="btn btn-primary btn-sm">Edit</a>
                                </li>
                            {% endfor %}
                        </ul>
                    </div>

                    <button id="toggleJournalButton" class="btn btn-primary">See Entries</button>
                </div>

                <!-- Move "Daily Goals for Improvement" here -->
                <div class="content-box">
                    <section id="dailyGoals">
                        <h2>Daily Goals for Mood Improvement</h2>
                        <ul id="goalsList">
                            <!-- Your goals with checkboxes and delete buttons will be added here dynamically -->
                        </ul>
                        <div class="form-group">
                            <input type="text" id="newGoal" placeholder="Add a new goal" class="form-control">
                        </div>
                        <button id="addGoal" class="btn btn-primary">Add Goal</button>
                    </section>
                </div>
            </div>

            <div class="col-md-6">
                <div class="content-box">
                    <a href="{{ url_for('daily_assessment') }}" class="btn btn-primary">CLICK HERE TO LOG YOUR DAILY MOOD</a>
                    <div id="dailyAssessment">
                        <p>Moody Daily for: {{ today_date }}</p>
                        {% if latest_assessment %}
                        <p>Today's weather is {{ latest_assessment.weather_today }}!</p>
                        <p>You are feeling {{ latest_assessment.mood_today }}.</p>
                        <p>Your stress level is at a {{ latest_assessment.stress_level }}.</p>
                        <p>Your current mood level is at a {{ latest_assessment.positive_affect_rating }}!</p>
                    {% else %}
                        <p>Today's weather is ?</p>
                        <p>You are feeling ??</p>
                        <p>Your stress level is at a ???</p>
                        <p>Your current mood level is at a ????</p>
                    {% endif %}

                    <a href="{{ url_for('mood_symptom') }}" class="btn btn-primary">Take Mood Assessment</a>
                    </div>
                </div>

                <div class="content-box">
                    <button id="toggleMoodHistory" class="btn btn-primary mt-4">Show Mood History</button>
                    <div id="moodHistory">
                        <!-- Display the average values -->
                        <div id="averageMoodData" style="display: none;">
                            <h2>Average Mood Data</h2>
                            <p>Most Common Weather: {{ weather_today_choices }}</p>
                            <p>Top Moods: {{ top_moods | join(', ') }}</p>
                            <p>Average Stress Level: {{ average_stress_level }}</p>
                            <p>Average Positive Affect Rating: {{ average_positive_affect_rating }}</p>
                        </div>

                        <!-- Add a new section for the mood history -->
                        <h2>Mood History</h2>
                        <ul>
                            {% for mood_entry in mood_history_entries %}
                                
                                    <p><b><u>Date: {{ mood_entry.date }}</u></b></p>
                                    <p>Weather: {{ mood_entry.weather_today }}</p>
                                    <p>Mood: {{ mood_entry.mood_today }}</p>
                                    <p>Stress Level: {{ mood_entry.stress_level }}</p>
                                    <p>Positive Affect Rating: {{ mood_entry.positive_affect_rating }}</p>
                                
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Move the "Moody Calendar" section to the bottom -->
    <div class="container mt-4">
        <div class="row">
            <div class="content-box col-md-12">
                <h2>Moody Calendar</h2>
                <h4>Your Local Weather</h4>
                <div id="calendar">
                    <section id="moodyCalendar"></section>
                </div>

                <div id="calendar">
                    <button id="toggleView" class="btn btn-primary">See Full Month</button>
                </div>
            </div>
        </div>
    </div>

    <a href="/" class="btn btn-primary">Back to Home</a>

 

{% endblock %}
